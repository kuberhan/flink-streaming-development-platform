(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35f18d01"],{"258a":function(t,e,n){"use strict";n("90c1")},"53cf":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[0==t.subPageFlag?n("div",{class:t.backFlag?"fl-container2":"fl-container"},[1==t.backFlag?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"返回",placement:"right"}},[n("i",{ref:"backbutton",staticClass:"el-icon-d-arrow-left fl-back",on:{click:function(e){return t.handleBack()}}})]):t._e(),n("el-form",{ref:"queryform",attrs:{model:t.queryform,inline:!0}},[n("el-form-item",[n("el-input",{staticClass:"wl-input",attrs:{placeholder:"任务编号"},on:{input:function(e){return t.handleQuery()}},model:{value:t.queryform.jobConfigId,callback:function(e){t.$set(t.queryform,"jobConfigId",e)},expression:"queryform.jobConfigId"}})],1),n("el-form-item",[n("el-input",{staticClass:"wl-input",attrs:{placeholder:"任务名称(模糊查询)"},on:{input:function(e){return t.handleQuery()}},model:{value:t.queryform.jobName,callback:function(e){t.$set(t.queryform,"jobName",e)},expression:"queryform.jobName"}},[n("el-button",{staticClass:"wl-search",attrs:{slot:"append",type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.handleQuery()}},slot:"append"})],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleQuery()}}},[t._v("查询")])],1)],1),n("el-table",{staticClass:"wl-table",attrs:{data:t.list,"header-cell-style":{background:"#f4f4f5","text-align":"center"},border:""}},[n("el-table-column",{attrs:{prop:"id","show-overflow-tooltip":!0,label:"编号","min-width":"60",width:"80",align:"center",fixed:""}}),n("el-table-column",{attrs:{prop:"jobConfigId","show-overflow-tooltip":!0,label:"任务编号","min-width":"60",width:"80",align:"center",fixed:""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",{staticStyle:{"margin-right":"5px"}},[t._v(t._s(e.row.jobConfigId))]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.getTaskTypeName(e.row.jobTypeEnum),placement:"right"}},["SQL_STREAMING"===e.row.jobTypeEnum?n("i",{staticClass:"iconfont my-icon-jiediansql",staticStyle:{"font-size":"16px"}}):t._e(),"SQL_BATCH"===e.row.jobTypeEnum?n("i",{staticClass:"iconfont my-icon-file-SQL",staticStyle:{"font-size":"16px"}}):t._e(),"JAR"===e.row.jobTypeEnum?n("i",{staticClass:"iconfont my-icon-suffix-jar",staticStyle:{"font-size":"16px"}}):t._e()])]}}],null,!1,845553989)}),n("el-table-column",{attrs:{prop:"version","show-overflow-tooltip":!0,label:"版本号","min-width":"60",width:"80",align:"center",fixed:""}}),n("el-table-column",{attrs:{prop:"jobName","show-overflow-tooltip":!0,label:"任务名称","min-width":"100",align:"center",fixed:""}}),n("el-table-column",{attrs:{prop:"jobDesc","show-overflow-tooltip":!0,label:"版本说明","min-width":"150",align:"center",fixed:""}}),n("el-table-column",{attrs:{prop:"deployMode","show-overflow-tooltip":!0,label:"运行模式",width:"105",align:"center"}}),n("el-table-column",{attrs:{prop:"createTime","show-overflow-tooltip":!0,label:"创建时间","min-width":"100",width:"135",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.formatDateTime(e.row.createTime)))])]}}],null,!1,3493597268)}),n("el-table-column",{attrs:{prop:"editor","show-overflow-tooltip":!0,label:"提交人员","min-width":"70",width:"100",align:"center"}}),n("el-table-column",{attrs:{label:"详情",width:"115",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("router-link",{attrs:{to:{name:t.getRouteTaskName(e.row.jobTypeEnum),params:{flag:"history",context:t.queryContent(),data:e.row}}}},[n("el-link",{attrs:{type:"info",icon:"el-icon-message"}},[t._v("详情")])],1)]}}],null,!1,2706779005)})],1),t.pageshow?n("el-pagination",{staticClass:"wl-pagination",attrs:{background:"",layout:"total, sizes, prev, pager, next","current-page":t.currentPage,"page-sizes":[10,15,20,50,100,150,200],"page-size":t.pageSize,total:t.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1):t._e(),n("router-view")],1)},o=[],r=(n("b0c0"),n("ac1f"),n("5319"),n("d3b7"),n("159b"),n("b199")),i={name:"HistoryTask",data:function(){return{loading:!1,subPageFlag:!1,backFlag:!1,params:{flag:"",data:{},context:""},queryform:{jobConfigId:"",jobName:""},list:[],count:0,pageSize:15,currentPage:1,pageshow:!0}},mounted:function(){if("HistoryTask"===this.$route.name){this.subPageFlag=!1;var t=this.$route.params;t&&(this.params.flag=t.flag,this.queryform.jobConfigId=t.jobConfigId?t.jobConfigId:"",this.queryform.jobName=t.jobName?t.jobName:"",t.currentPage&&(this.count=t.count,this.currentPage=t.currentPage,this.pageSize=t.pageSize),"tasklist"===t.flag&&(this.backFlag=!0,this.params.flag=t.flag,this.params.data=t.data,this.params.context=t.context),t.parentContent&&(this.backFlag=!0,this.params.context=t.parentContent)),this.handleQuery()}else this.subPageFlag=!0},methods:{handleBack:function(){this.$router.replace({name:"FlinkTaskManage",params:this.params.context})},queryContent:function(){return{count:this.count,currentPage:this.currentPage,pageSize:this.pageSize,jobConfigId:this.queryform.jobConfigId,jobName:this.queryform.jobName,parentContent:this.params.context}},handleSizeChange:function(t){this.pageSize=t,this.handleQuery()},handleCurrentChange:function(t){this.currentPage=t,this.handleQuery()},handleQuery:function(){var t=this;this.pageshow=!1,this.getTaskHistory(),this.$nextTick((function(){t.pageshow=!0}))},getTaskHistory:function(){var t=this;this.loading=!0;var e={pageNum:this.currentPage,pageSize:this.pageSize,jobConfigId:this.queryform.jobConfigId,jobName:this.queryform.jobName};Object(r["g"])(e).then((function(e){t.loading=!1;var n=e.code,a=e.success,o=e.message,r=e.data;"200"===n&&a?(t.count=r.total,t.list=r.data,t.list.forEach((function(t){t.deployModeEnum=t.deployMode})),t.count>0&&0==t.list.length&&(t.currentPage=Math.ceil(t.count/t.pageSize),t.getTaskHistory(r))):t.$message({type:"error",message:o||"请求数据异常！"})})).catch((function(e){t.loading=!1,t.$message({type:"error",message:"请求异常！"}),console.log(e)}))},formatDateTime:function(t){return this.dayjs(t).format("YYYY-MM-DD HH:mm:ss")},getTaskTypeName:function(t){switch(t){case"SQL_STREAMING":return"SQL流任务";case"SQL_BATCH":return"SQL批任务";case"JAR":return"JAR包";default:return t}},getRouteTaskName:function(t){switch(t){case"SQL_STREAMING":return"ViewHistorySqlStreamingTask";case"SQL_BATCH":return"ViewHistorySqlBatchTask";case"JAR":return"ViewHistoryJarTask";default:return""}}}},s=i,u=(n("258a"),n("2877")),l=Object(u["a"])(s,a,o,!1,null,"2bbca4f8",null);e["default"]=l.exports},"90c1":function(t,e,n){},b199:function(t,e,n){"use strict";n.d(e,"h",(function(){return i})),n.d(e,"i",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"l",(function(){return l})),n.d(e,"m",(function(){return c})),n.d(e,"k",(function(){return f})),n.d(e,"j",(function(){return d})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return m})),n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return g})),n.d(e,"f",(function(){return b})),n.d(e,"g",(function(){return w}));var a=n("b775"),o=n("4328"),r=n.n(o);function i(t,e,n,o,i,s,u){return Object(a["a"])({url:"/listTask",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{pageNum:t,pageSize:e,jobName:n,jobId:o,jobType:i,status:s,open:u}})}function s(t){return Object(a["a"])({url:"/open",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t}})}function u(t){return Object(a["a"])({url:"/close",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t}})}function l(t){return Object(a["a"])({url:"/start",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t}})}function c(t){return Object(a["a"])({url:"/stop",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t}})}function f(t,e){return Object(a["a"])({url:"/start",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t,savepointId:e}})}function d(t){return Object(a["a"])({url:"/savepoint",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t}})}function p(t){return Object(a["a"])({url:"/copyConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t}})}function m(t){return Object(a["a"])({url:"/delete",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{id:t}})}function h(t){return Object(a["a"])({url:"/checkfSql",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:{flinkSql:t}})}function g(t){return Object(a["a"])({url:"/addConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:t})}function b(t){return Object(a["a"])({url:"/editConfig",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:t})}function w(t){return Object(a["a"])({url:"/jobConfigHistoryPage",method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:[function(t){return r.a.stringify(t)}],data:t})}}}]);